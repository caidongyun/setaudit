{"name":"Setaudit","body":"setaudit\r\n========\r\n\r\nsetaudit a BSD libbsm audit context setting tool\r\n\r\n###Compile:###\r\n\r\n```bash\r\ngit clone http://github.com/shadowbq/setaudit.git\r\ncd setaudit\r\ngmake\r\nsudo gmake install\r\n```\r\n\r\n###Usage:###\r\n\r\n```bash\r\n$ /usr/local/sbin/setaudit \r\nusage: ./setaudit [-a auid] [-m mask] [-s source] [-p port] comand ...\r\n```\r\n\r\n###Example Usage:###\r\n\r\n```bash\r\nsetaudit -a www -m ex /usr/local/etc/rc.d/apache22 restart\r\n```\r\n\r\n###Notes:###\r\n\r\nOpenBSM http://en.wikipedia.org/wiki/OpenBSM\r\n\r\nBased on http://www.opensource.apple.com/source/bsm/\r\n\r\n###Real Life:###\r\n\r\nAudit Configuration (Note: setaudit does not correctly read in /etc/security/audit_ configs)\r\n\r\n```bash\r\n#BSM audit_user config\r\nwww:all:no\r\n```\r\n\r\nClear the file location `/tmp/foo`\r\n\r\n```bash\r\n[root@machine ~]# rm /tmp/foo \r\n```\r\n\r\nSudoing as www user and touch the file `/tmp/foo` show no audit log\r\n```bash\r\n[root@machine ~]# sudo -u www touch /tmp/foo\r\n[root@machine ~]# auditreduce -u www -o file=/tmp/foo /var/audit/current |praudit\r\n[root@machine ~]# \r\n```\r\n\r\nClear the file location `/tmp/foo` & audit log\r\n\r\n```bash\r\n[root@machine ~]# rm /tmp/foo \r\n[root@machine ~]# audit -n\r\n```\r\nSetaudit and Sudo as www user and touch the file `/tmp/foo` shows correct www audit log\r\n```bash\r\n[root@machine ~]# setaudit -a www -m all sudo -u www touch /tmp/foo\r\n[root@machine ~]# auditreduce -u www -o file=/tmp/foo /var/audit/current |praudit\r\nheader,97,11,stat(2),0,Mon May  7 11:31:05 2012, + 321 msec\r\npath,/tmp/foo\r\nsubject,www,www,www,www,www,1713,0,0,0.0.0.0\r\nreturn,failure : No such file or directory,4294967295\r\ntrailer,97\r\nheader,124,11,open(2) - write,creat,0,Mon May  7 11:31:05 2012, + 321 msec\r\nargument,3,0x1b6,mode\r\nargument,2,0x201,flags\r\npath,/tmp/foo\r\nsubject,www,www,www,www,www,1713,0,0,0.0.0.0\r\nreturn,success,3\r\ntrailer,124\r\n\r\n```","tagline":"setaudit a BSD libbsm audit context setting tool","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}